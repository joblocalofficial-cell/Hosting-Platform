
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>JobLocal - ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script> 
    
    <style>
        body { font-family: 'Sukhumvit Set', 'Arial', sans-serif; max-width: 600px; margin: 0 auto; padding: 20px 15px; background-color: #f8f8f8; color: #333; }
        .container { background-color: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); padding: 20px; }

        header { display: flex; gap: 15px; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        #avatar { width: 56px; height: 56px; border-radius: 50%; object-fit: cover; background: #eee; }
        #hello { font-size: 1.1em; font-weight: bold; margin-bottom: 2px; color: #00b900; }
        #uid { font-size: 0.8em; color: #888; }
        
        h2 { font-size: 1.5em; color: #333; margin-top: 25px; margin-bottom: 15px; border-left: 5px solid #00b900; padding-left: 10px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 0.95em; }
        
        input, select, textarea { 
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; 
            box-sizing: border-box; font-size: 1em; transition: border-color 0.3s;
            background-color: #fff;
        }
        input:focus, select:focus, textarea:focus { border-color: #00b900; outline: none; box-shadow: 0 0 0 3px rgba(0, 185, 0, 0.1); }
        
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        @media (max-width: 400px) { .row { grid-template-columns: 1fr; } }

        .pdpa-group { background-color: #e6ffe6; border: 1px solid #00b900; padding: 15px; border-radius: 8px; margin-bottom: 25px; }
        .pdpa-group label { font-weight: normal; display: flex; align-items: flex-start; margin-bottom: 0; }
        .pdpa-group input[type="checkbox"] { width: auto; margin-right: 10px; margin-top: 2px; }
        .pdpa-consent-text { margin-top: 10px; font-size: 0.85em; }
        .pdpa-consent-text a { color: #008800; text-decoration: none; font-weight: bold; cursor: pointer; }
        
        button { 
            background-color: #00b900; color: white; padding: 14px 20px; 
            border: none; border-radius: 8px; cursor: pointer; width: 100%; 
            font-size: 1.1em; font-weight: bold; transition: background-color 0.3s;
            margin-bottom: 10px;
        }
        button:hover:enabled { background-color: #008800; }
        button:disabled { background-color: #b3e6b3; cursor: not-allowed; }
        
        .status { margin-top: 10px; font-size: 0.9em; text-align: center; color: #666; }
        .hidden { display: none !important; }
        .hint { font-size: 0.8em; color: #cc0000; margin-top: -15px; margin-bottom: 15px; }

        .history-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-top: 15px; background-color: #f9f9f9; border-left: 5px solid #00b900; }
        .history-item { margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dashed #eee; }
        .history-item:last-child { border-bottom: none; margin-bottom: 0; }
        .history-label { font-weight: bold; color: #555; font-size: 0.85em; display: inline-block; width: 150px; }
        .history-value { font-weight: normal; color: #333; font-size: 0.95em; }
        
        .btn-warning { background-color: #ff9800; }
        .btn-warning:hover:enabled { background-color: #e68900; }
        .btn-info { background-color: #17a2b8; }
        .btn-info:hover:enabled { background-color: #138496; }
        .btn-secondary { background-color: #6c757d; }
        .btn-secondary:hover:enabled { background-color: #5a6268; }

        #pdpaModal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.5); display: none; justify-content: center;
            align-items: center; z-index: 1000;
        }
        .modal-content {
            background: #fff; padding: 25px; border-radius: 10px; max-width: 90%;
            max-height: 80%; overflow-y: auto; position: relative;
        }
        .modal-content h3 { color: #00b900; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-top: 0; }
        .modal-content p { font-size: 0.9em; line-height: 1.6; }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 20px; cursor: pointer; color: #888; }
        .close-btn:hover { color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img id="avatar" alt="Avatar">
            <div>
                <div id="hello">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE...</div>
                <small id="uid">userId: -</small>
            </div>
        </header>

        <!-- ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° -->
        <div id="form-view">
            <form id="f">
                <div class="pdpa-group form-group">
                    <label for="consent_pdpa">
                        <input type="checkbox" id="consent_pdpa" name="consent_pdpa" required>
                        **‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô PDPA** (‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç)
                    </label>
                    <div class="pdpa-consent-text">
                        <a id="showPdpaModal">‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°</a>
                    </div>
                </div>

                <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á</h2>
                
                <div class="form-group">
                    <label for="user_type">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏Ñ‡∏£/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î?</label>
                    <select id="user_type" name="user_type" required>
                        <option value="" disabled selected>--- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ---</option>
                        <option value="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó / ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó / ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</option>
                        <option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ / ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏¢‡πà‡∏≠‡∏¢">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ / ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏¢‡πà‡∏≠‡∏¢</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="company_or_org">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó / ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ú‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á</label>
                    <input id="company_or_org" name="company_or_org" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó / ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•" required>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="contact_person">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                        <input id="contact_person" name="contact_person" required>
                    </div>
                    <div class="form-group">
                        <label for="contact_phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                        <input id="contact_phone" name="contact_phone" type="tel" pattern="[0-9]{10}" placeholder="0812345678" required>
                    </div>
                </div>

                <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô</h2>

                <div class="row">
                    <div class="form-group">
                        <label for="job_title_select">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô</label>
                        <select id="job_title_select" name="job_title_select" required>
                            <option value="" disabled selected>--- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ---</option>
                            <option value="‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü</option>
                            <option value="‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢</option>
                            <option value="‡∏ä‡πà‡∏≤‡∏á‡∏ã‡πà‡∏≠‡∏°">‡∏ä‡πà‡∏≤‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                            <option value="‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô">‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô</option>
                            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏)</option>
                        </select>
                    </div>
                    <div class="form-group hidden" id="job_title_other_group">
                        <label for="job_title_other">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô (‡∏£‡∏∞‡∏ö‡∏∏)</label>
                        <input id="job_title_other" name="job_title_other" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£">
                    </div>
                    
                    <div class="form-group">
                        <label for="job_category">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</label>
                        <select id="job_category" name="job_category" required>
                            <option value="" disabled selected>--- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏á‡∏≤‡∏ô ---</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Service)">‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Service)</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢ (Sales)">‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢ (Sales)</option>
                            <option value="‡∏á‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô / ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î (Housekeeping)">‡∏á‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô / ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á / ‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (Technician)">‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á / ‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ / ‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á (Driver)">‡∏á‡∏≤‡∏ô‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ / ‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡∏ß / ‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (Kitchen)">‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡∏ß / ‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡πÅ‡∏ü / ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (Caf√© & Restaurant)">‡∏á‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡πÅ‡∏ü / ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ / ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (General Labor)">‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ / ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                            <option value="‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® / ‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£ (Office / Admin)">‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® / ‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="job_description">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô / ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥</label>
                    <textarea id="job_description" name="job_description" rows="3" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà/‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÇ‡∏î‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"></textarea>
                </div>

                <div class="form-group">
                    <label for="location_area">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                    <input id="location_area" name="location_area" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ A ‡∏™‡∏≤‡∏Ç‡∏≤‡∏Ñ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á" required>
                </div>

                <div class="form-group">
                    <label for="district">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï (‡πÉ‡∏ô‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ)</label>
                    <select id="district" name="district" required>
                        <option value="" disabled selected>--- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ---</option>
                        <option value="‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ">‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ</option>
                        <option value="‡∏Ñ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á">‡∏Ñ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á</option>
                        <option value="‡∏ò‡∏±‡∏ç‡∏ö‡∏∏‡∏£‡∏µ">‡∏ò‡∏±‡∏ç‡∏ö‡∏∏‡∏£‡∏µ</option>
                        <option value="‡∏´‡∏ô‡∏≠‡∏á‡πÄ‡∏™‡∏∑‡∏≠">‡∏´‡∏ô‡∏≠‡∏á‡πÄ‡∏™‡∏∑‡∏≠</option>
                        <option value="‡∏•‡∏≤‡∏î‡∏´‡∏•‡∏∏‡∏°‡πÅ‡∏Å‡πâ‡∏ß">‡∏•‡∏≤‡∏î‡∏´‡∏•‡∏∏‡∏°‡πÅ‡∏Å‡πâ‡∏ß</option>
                        <option value="‡∏•‡∏≥‡∏•‡∏π‡∏Å‡∏Å‡∏≤">‡∏•‡∏≥‡∏•‡∏π‡∏Å‡∏Å‡∏≤</option>
                        <option value="‡∏™‡∏≤‡∏°‡πÇ‡∏Ñ‡∏Å">‡∏™‡∏≤‡∏°‡πÇ‡∏Ñ‡∏Å</option>
                    </select>
                </div>

                <div class="row">
                    <div class="form-group">
                        <label for="headcount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</label>
                        <input id="headcount" name="headcount" type="number" min="1" value="1" required>
                    </div>
                    <div class="form-group">
                        <label for="wage_type">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á</label>
                        <select id="wage_type" name="wage_type" required>
                            <option value="" disabled selected>--- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ---</option>
                            <option value="‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏•‡∏∞">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏•‡∏∞</option>
                            <option value="‡∏ß‡∏±‡∏ô‡∏•‡∏∞">‡∏ß‡∏±‡∏ô‡∏•‡∏∞</option>
                            <option value="‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á">‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group hidden" id="lump_sum_days_group">
                    <label for="lump_sum_days">‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏µ‡πà‡∏ß‡∏±‡∏ô?</label>
                    <input id="lump_sum_days" name="lump_sum_days" type="number" min="1" placeholder="‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô">
                </div>
                
                <div class="form-group">
                    <label for="wage_amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡∏ö‡∏≤‡∏ó)</label>
                    <input id="wage_amount" name="wage_amount" type="number" placeholder="‡πÄ‡∏ä‡πà‡∏ô 350, 15000" required>
                    <div class="hint">*‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="start_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                        <input id="start_date" name="start_date" type="date">
                    </div>
                    <div class="form-group">
                        <label for="start_time">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</label>
                        <input id="start_time" name="start_time" type="time">
                    </div>
                </div>

                <div class="form-group">
                    <label for="contact_line_id">LINE ID ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                    <input id="contact_line_id" name="contact_line_id" placeholder="‡πÄ‡∏ä‡πà‡∏ô joblocal_contact">
                </div>

                <button id="submitBtn" type="submit" disabled>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE‚Ä¶</button>
                <div id="status" class="status"></div>
            </form>
        </div>
        
        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ -->
        <div id="history-view" class="hidden">
            <h2 style="color: #00b900;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô üìÑ</h2>
            <p id="history-message" style="font-size: 0.9em; margin-bottom: 20px;">
                ‚úÖ ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
            </p>
            
            <div id="latest-submission-card" class="history-card"></div>

            <button id="resubmitBtn" class="btn-warning">üìù ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
            <button id="shareFlexBtn" class="btn-info">üì¢ ‡πÅ‡∏ä‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô (Flex Message)</button>
            <button id="closeWindowBtn" class="btn-secondary">‚ùå ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
        </div>
    </div>

    <!-- PDPA Modal -->
    <div id="pdpaModal">
        <div class="modal-content">
            <span class="close-btn" id="closePdpaModal">&times;</span>
            <h3>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°</h3>
            <p>‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏° ‡πÉ‡∏ä‡πâ ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏ï‡∏≤‡∏°‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏û.‡∏®. 2562...</p>
            <h4>1. ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
            <ul>
                <li>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏´‡∏≤‡∏á‡∏≤‡∏ô</li>
                <li>‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô</li>
                <li>‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
            </ul>
        </div>
    </div>

    <script>
    const LIFF_ID = "2008394776-k9v7m3Wg"; 
    const GAS_ENDPOINT = "https://script.google.com/macros/s/AKfycbzaCtiMdjlWzA3f95yH7vdjwYdi-8KJZ9zGjPOlQYVveLvFMHwyDlsnlxEMWiJE_xK2zQ/exec";  

    const $ = id => document.getElementById(id);
    
    let userProfile = {};
    let userIdToken = '';
    let liffReady = false;
    let latestSubmissionData = null;

    const form = $("f");
    const formView = $("form-view");
    const historyView = $("history-view");
    const submitBtn = $("submitBtn");
    const statusDiv = $("status");
    const resubmitBtn = $("resubmitBtn");
    const shareFlexBtn = $("shareFlexBtn");
    const closeWindowBtn = $("closeWindowBtn");

    // Initialize LIFF
    async function initializeLiff() {
        try {
            await liff.init({ liffId: LIFF_ID });
            
            if (!liff.isLoggedIn()) {
                liff.login();
                return;
            }
            
            userProfile = await liff.getProfile();
            userIdToken = liff.getIDToken();
            liffReady = true;

            $("hello").textContent = `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞, ${userProfile.displayName}`;
            $("uid").textContent = `User ID: ${userProfile.userId.substring(0, 10)}...`;
            if (userProfile.pictureUrl) $("avatar").src = userProfile.pictureUrl;
            
            const hasSubmitted = await checkSubmissionHistory(userProfile.userId);
            showView(hasSubmitted ? 'history' : 'form');

        } catch (error) {
            console.error("LIFF init failed", error);
            $("hello").textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE";
        }
    }

    // Check submission history
    async function checkSubmissionHistory(userId) {
        statusDiv.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥...";
        try {
            const res = await fetch(`${GAS_ENDPOINT}?userId=${userId}`);
            const json = await res.json();
            
            console.log("History:", json);

            if (json.status === "check_history" && json.hasSubmitted && json.latestSubmission) {
                latestSubmissionData = json.latestSubmission;
                renderHistoryCard(latestSubmissionData);
                return true;
            } else {
                statusDiv.textContent = "‚úÖ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô";
                return false;
            }
        } catch (err) {
            console.error("Error checking history:", err);
            statusDiv.textContent = "‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ";
            return false;
        }
    }

    // Render history card
    function renderHistoryCard(data) {
        let html = '<p style="color:#00b900; font-weight:bold; margin-bottom: 15px;">**‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î**</p>';
        
        const displayMap = {
            '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà-‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î',
            '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞',
            '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô': '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô',
            '‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•': '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•',
            '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå': '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠',
            '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô': '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô',
            '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô': '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô',
            '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',
            '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠': '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà',
            '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á': '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á',
            '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡∏ö‡∏≤‡∏ó)': '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á',
            '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô',
            '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô': '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô'
        };

        for (const key in data) {
            if (data[key] && displayMap[key]) {
                const label = displayMap[key];
                let value = data[key];
                
                if (key === '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡∏ö‡∏≤‡∏ó)') {
                    value = `${parseFloat(value).toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó`;
                }

                html += `
                    <div class="history-item">
                        <span class="history-label">${label}:</span>
                        <span class="history-value">${value}</span>
                    </div>
                `;
            }
        }

        $("latest-submission-card").innerHTML = html;
    }

    // Show view
    function showView(viewName) {
        if (viewName === 'form') {
            formView.classList.remove('hidden');
            historyView.classList.add('hidden');
            submitBtn.disabled = false;
            submitBtn.textContent = "‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô";
        } else {
            formView.classList.add('hidden');
            historyView.classList.remove('hidden');
        }
    }

    // Form submission
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (!liffReady) {
            statusDiv.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà";
            return;
        }

        const finalJobTitle = $("job_title_select").value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' 
            ? $("job_title_other").value 
            : $("job_title_select").value;

        const formData = {
            pdpa_consent: $("consent_pdpa").checked ? "‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö" : "‡πÑ‡∏°‡πà‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö",
            user_type: $("user_type").value,
            company_or_org: $("company_or_org").value,
            contact_person: $("contact_person").value,
            contact_phone: $("contact_phone").value,
            job_title: finalJobTitle,
            job_category: $("job_category").value,
            job_description: $("job_description").value,
            location_area: $("location_area").value,
            district: $("district").value,
            headcount: $("headcount").value,
            wage_type: $("wage_type").value,
            lump_sum_days: $("wage_type").value === '‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á' ? $("lump_sum_days").value : "",
            wage_amount: $("wage_amount").value,
            start_date: $("start_date").value,
            start_time: $("start_time").value,
            contact_line_id: $("contact_line_id").value
        };

        submitBtn.disabled = true;
        submitBtn.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...";
        statusDiv.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶";

        const payload = {
            idToken: userIdToken,
            profile: {
                userId: userProfile.userId,
                displayName: userProfile.displayName,
                pictureUrl: userProfile.pictureUrl || ""
            },
            data: formData
        };

        try {
            const res = await fetch(GAS_ENDPOINT, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });

            const json = await res.json();
            
            if (json.ok) {
                statusDiv.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!";
                await checkSubmissionHistory(userProfile.userId);
                showView('history');
            } else {
                throw new Error(json.error || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î");
            }
        } catch (err) {
            console.error("Error:", err);
            statusDiv.textContent = "‚ùå ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + err.message;
            submitBtn.disabled = false;
            submitBtn.textContent = "‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô";
        }
    });

    // Resubmit button
    resubmitBtn.addEventListener('click', () => {
        showView('form');
        form.reset();
        statusDiv.textContent = "üìù ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà";
    });

    // Share Flex Message
    shareFlexBtn.addEventListener('click', async () => {
        if (!latestSubmissionData) {
            alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô");
            return;
        }

        const flexMessage = createFlexMessage(latestSubmissionData);
        
        try {
            if (liff.isApiAvailable('shareTargetPicker')) {
                await liff.shareTargetPicker([flexMessage]);
                alert("‚úÖ ‡πÅ‡∏ä‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            } else {
                alert("‚ùå ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô LINE App");
            }
        } catch (err) {
            console.error("Share error:", err);
            alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏î‡πâ: " + err.message);
        }
    });

    // Create Flex Message
    function createFlexMessage(data) {
        const wage = data['‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á'] === '‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á' && data['‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏Å‡∏µ‡πà‡∏ß‡∏±‡∏ô']
            ? `${parseFloat(data['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡∏ö‡∏≤‡∏ó)']).toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó (‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á ${data['‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏Å‡∏µ‡πà‡∏ß‡∏±‡∏ô']} ‡∏ß‡∏±‡∏ô)`
            : `${data['‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á']} ${parseFloat(data['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á (‡∏ö‡∏≤‡∏ó)']).toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó`;

        return {
            type: "flex",
            altText: `üîî ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏á‡∏≤‡∏ô: ${data['‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô']} - ${data['‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•']}`,
            contents: {
                type: "bubble",
                size: "mega",
                header: {
                    type: "box",
                    layout: "vertical",
                    contents: [
                        {
                            type: "box",
                            layout: "vertical",
                            contents: [
                                {
                                    type: "text",
                                    text: "üíº ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô",
                                    color: "#ffffff",
                                    size: "sm",
                                    weight: "bold"
                                },
                                {
                                    type: "text",
                                    text: data['‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏",
                                    color: "#ffffff",
                                    size: "xl",
                                    weight: "bold",
                                    margin: "md"
                                }
                            ]
                        }
                    ],
                    paddingAll: "20px",
                    backgroundColor: "#00b900",
                    spacing: "md",
                    height: "100px",
                    paddingTop: "22px"
                },
                body: {
                    type: "box",
                    layout: "vertical",
                    contents: [
                        {
                            type: "box",
                            layout: "vertical",
                            contents: [
                                {
                                    type: "text",
                                    text: data['‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏",
                                    size: "lg",
                                    weight: "bold",
                                    color: "#333333"
                                },
                                {
                                    type: "text",
                                    text: data['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏",
                                    size: "sm",
                                    color: "#999999",
                                    margin: "xs"
                                }
                            ],
                            spacing: "xs"
                        },
                        {
                            type: "separator",
                            margin: "lg"
                        },
                        {
                            type: "box",
                            layout: "vertical",
                            contents: [
                                createInfoRow("üìç", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà", data['‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"),
                                createInfoRow("üó∫Ô∏è", "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà", data['‡∏≠‡∏≥‡πÄ‡∏†‡∏≠'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"),
                                createInfoRow("üí∞", "‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á", wage),
                                createInfoRow("üë•", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô", `${data['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£'] || "1"} ‡∏Ñ‡∏ô`),
                                createInfoRow("üìÖ", "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", data['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô'] ? `${data['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô']} ${data['‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô'] || ''}` : "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á")
                            ],
                            spacing: "md",
                            margin: "lg"
                        }
                    ],
                    spacing: "md"
                },
                footer: {
                    type: "box",
                    layout: "vertical",
                    contents: [
                        {
                            type: "box",
                            layout: "vertical",
                            contents: [
                                {
                                    type: "text",
                                    text: "üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°",
                                    size: "xs",
                                    color: "#999999",
                                    weight: "bold"
                                },
                                {
                                    type: "text",
                                    text: data['‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏",
                                    size: "sm",
                                    color: "#333333",
                                    margin: "xs"
                                },
                                {
                                    type: "text",
                                    text: `‡πÇ‡∏ó‡∏£: ${data['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå'] || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}`,
                                    size: "sm",
                                    color: "#00b900",
                                    margin: "xs",
                                    weight: "bold"
                                }
                            ],
                            spacing: "xs"
                        },
                        {
                            type: "separator",
                            margin: "md"
                        },
                        {
                            type: "box",
                            layout: "horizontal",
                            contents: [
                                {
                                    type: "button",
                                    action: {
                                        type: "uri",
                                        label: "üìû ‡πÇ‡∏ó‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°",
                                        uri: `tel:${data['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå'] || ''}`
                                    },
                                    style: "primary",
                                    color: "#00b900",
                                    height: "sm"
                                }
                            ],
                            margin: "md"
                        },
                        {
                            type: "box",
                            layout: "vertical",
                            contents: [
                                {
                                    type: "text",
                                    text: "üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏à‡∏≤‡∏Å JobLocal Pathum Thani",
                                    size: "xxs",
                                    color: "#999999",
                                    align: "center"
                                }
                            ],
                            margin: "md"
                        }
                    ],
                    spacing: "sm",
                    paddingAll: "13px"
                }
            }
        };
    }

    // Helper function for Flex info row
    function createInfoRow(icon, label, value) {
        return {
            type: "box",
            layout: "horizontal",
            contents: [
                {
                    type: "text",
                    text: icon,
                    size: "sm",
                    flex: 0
                },
                {
                    type: "text",
                    text: label,
                    size: "sm",
                    color: "#555555",
                    flex: 0,
                    margin: "sm"
                },
                {
                    type: "text",
                    text: value,
                    size: "sm",
                    color: "#111111",
                    align: "end",
                    wrap: true
                }
            ]
        };
    }

    // Close window button
    closeWindowBtn.addEventListener('click', () => {
        if (liff.closeWindow) {
            liff.closeWindow();
        } else {
            alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á");
        }
    });

    // PDPA Modal handlers
    $("showPdpaModal").addEventListener('click', () => {
        $("pdpaModal").style.display = 'flex';
    });
    $("closePdpaModal").addEventListener('click', () => {
        $("pdpaModal").style.display = 'none';
    });
    $("pdpaModal").addEventListener('click', (e) => {
        if (e.target.id === 'pdpaModal') {
            $("pdpaModal").style.display = 'none';
        }
    });

    // Conditional input handlers
    $("user_type").addEventListener('change', (e) => {
        const val = e.target.value;
        if (val === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' || val === '‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ / ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏¢‡πà‡∏≠‡∏¢') {
            $("company_or_org").placeholder = "‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•/‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£";
        } else {
            $("company_or_org").placeholder = "‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£";
        }
    });

    $("job_title_select").addEventListener('change', (e) => {
        if (e.target.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
            $("job_title_other_group").classList.remove('hidden');
            $("job_title_other").setAttribute('required', 'required');
        } else {
            $("job_title_other_group").classList.add('hidden');
            $("job_title_other").removeAttribute('required');
        }
    });

    $("wage_type").addEventListener('change', (e) => {
        if (e.target.value === '‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πâ‡∏≤‡∏á') {
            $("lump_sum_days_group").classList.remove('hidden');
            $("lump_sum_days").setAttribute('required', 'required');
        } else {
            $("lump_sum_days_group").classList.add('hidden');
            $("lump_sum_days").removeAttribute('required');
            $("lump_sum_days").value = '';
        }
    });

    // Start LIFF
    initializeLiff();
    </script>
</body>
</html>
    
